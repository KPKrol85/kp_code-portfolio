(()=>{const e=document.querySelectorAll(".hidden");if(!e.length)return;if(!("IntersectionObserver"in window))return void e.forEach(e=>e.classList.add("show"));const t=.12,n=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.intersectionRatio>=t?requestAnimationFrame(()=>e.target.classList.add("show")):0===e.intersectionRatio&&e.target.classList.remove("show")})},{root:null,rootMargin:"0px 0px 10% 0px",threshold:[0,t,.5,1]});e.forEach(e=>n.observe(e));const r=()=>{e.forEach(e=>{((e,t=.12)=>{const n=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth;if(0===n.width||0===n.height)return!1;const a=Math.min(n.bottom,r)-Math.max(n.top,0),s=Math.min(n.right,i)-Math.max(n.left,0);return!(a<=0||s<=0)&&a*s/(n.width*n.height)>=t})(e)&&e.classList.add("show")})};requestAnimationFrame(()=>requestAnimationFrame(r)),window.addEventListener("load",()=>setTimeout(r,0),{once:!0}),window.addEventListener("pageshow",()=>setTimeout(r,0),{once:!0})})(),(()=>{const e=document.getElementById("themeToggleDesktop"),t=document.getElementById("themeToggleMobile"),n=document.getElementById("hamburgerIcon"),r=window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null,i=(r,i=!0)=>{const a="dark"===r;document.body.classList.toggle("dark-mode",a),(e=>{document.querySelectorAll(".logo-img[data-light][data-dark]").forEach(t=>{const n=e?t.dataset.dark:t.dataset.light;if(!n)return;const r=new URL(n,document.baseURI).href;t.src!==r&&t.setAttribute("src",n)})})(a),(e=>{if(!n)return;const t=e?n.dataset.dark:n.dataset.light;t&&n.getAttribute("src")!==t&&n.setAttribute("src",t)})(a),(n=>{const r=String(n),i=n?"Przełącz na jasny motyw":"Przełącz na ciemny motyw";e&&(e.setAttribute("aria-pressed",r),e.setAttribute("aria-label",i)),t&&(t.setAttribute("aria-pressed",r),t.setAttribute("aria-label",i))})(a),i&&((e,t)=>{try{localStorage.setItem(e,t)}catch{}})("theme",a?"dark":"light")},a=(e=>{try{return localStorage.getItem(e)}catch{return null}})("theme");i("dark"===a||"light"===a?a:r&&r.matches?"dark":"light",!1);const s=()=>i(document.body.classList.contains("dark-mode")?"light":"dark",!0);if(e&&e.addEventListener("click",s),t&&t.addEventListener("click",s),!a&&r){const e=e=>i(e.matches?"dark":"light",!1);r.addEventListener?r.addEventListener("change",e):r.addListener&&r.addListener(e)}})(),(()=>{const e=document.getElementById("hamburger"),t=document.getElementById("primaryNav");if(!e||!t)return;const n=window.matchMedia("(max-width: 768px)");e.hasAttribute("aria-expanded")||e.setAttribute("aria-expanded","false");let r=null;const i=()=>document.body.classList.remove("nav-open"),a=()=>{t.classList.remove("mobile-open"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Otwórz menu"),t.toggleAttribute("inert",!1),t.setAttribute("aria-hidden","false"),i(),d()},s=()=>{t.classList.remove("mobile-open"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Otwórz menu"),t.toggleAttribute("inert",!0),t.setAttribute("aria-hidden","true"),i(),d()},o=()=>{t.classList.remove("mobile-open"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Otwórz menu"),t.toggleAttribute("inert",!0),t.setAttribute("aria-hidden","true"),i(),(r||e).focus({preventScroll:!0}),r=null,d()},l=()=>{t.classList.add("mobile-open"),e.classList.add("active"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-label","Zamknij menu"),t.toggleAttribute("inert",!1),t.setAttribute("aria-hidden","false"),document.body.classList.add("nav-open"),r=document.activeElement instanceof HTMLElement?document.activeElement:e;const n=t.querySelector(".nav a");n&&"function"==typeof n.focus&&n.focus({preventScroll:!0}),function(){if(c)return;c=n=>{if(!t.classList.contains("mobile-open"))return;const r=t.contains(n.target),i=e.contains(n.target);r||i||o()},document.addEventListener("pointerdown",c,!0)}()};e.addEventListener("click",()=>t.classList.contains("mobile-open")?o():l()),document.addEventListener("keydown",e=>{"Escape"===e.key&&t.classList.contains("mobile-open")&&o()}),t.addEventListener("click",e=>{e.target.closest("a[href], area[href]")&&n.matches&&o()});let c=null;function d(){c&&(document.removeEventListener("pointerdown",c,!0),c=null)}const u=e=>{e.matches?s():a()};n.addEventListener?n.addEventListener("change",u):n.addListener&&n.addListener(u),n.matches?s():a()})(),(()=>{const e=document.getElementById("powrot-na-gore")||document.querySelector(".powrot-na-gore");if(!e)return;const t=document.scrollingElement||document.documentElement,n=()=>{return n=Math.max(0,"number"==typeof window.pageYOffset?window.pageYOffset:t.scrollTop)>300,e.classList.toggle("is-visible",n),e.setAttribute("aria-hidden",String(!n)),void(n?e.removeAttribute("inert"):e.setAttribute("inert",""));var n};let r=!1;n(),window.addEventListener("load",n,{once:!0}),window.addEventListener("pageshow",n,{once:!0}),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&n()}),window.addEventListener("resize",n,{passive:!0}),window.addEventListener("scroll",()=>{r||(r=!0,requestAnimationFrame(()=>{n(),r=!1}))},{passive:!0}),e.addEventListener("click",t=>{if(t.preventDefault(),!e.classList.contains("is-visible"))return;const n=!window.matchMedia("(prefers-reduced-motion: reduce)").matches;window.scrollTo({top:0,behavior:n?"smooth":"auto"})})})(),(()=>{const e=document.getElementById("contactForm");if(!e)return;const t=/localhost|127\.0\.0\.1/.test(location.hostname),n=e.querySelector("#formStatus"),r=e.querySelector(".submit-btn"),i=r?r.textContent:"Wyślij wiadomość",a=["name","email","subject","service","message"],s=e.querySelector("#message"),o=document.getElementById("messageCounter"),l=500,c=e.querySelector("#errorSummary"),d=e.querySelector("#skipToError");d&&d.addEventListener("click",t=>{t.preventDefault();const n=e.querySelector(".is-invalid");n&&n.focus()}),e.addEventListener("keydown",t=>{const n=t.key||t.code;if(t.altKey&&t.shiftKey&&("E"===n||"KeyE"===n)){const n=e.querySelector(".is-invalid");n&&(t.preventDefault(),n.focus())}});const u=e=>{e&&(e.classList.add("is-invalid"),e.setAttribute("aria-invalid","true"))},m=(e,t=!1)=>{n&&(n.classList.toggle("ok",!!t),n.classList.toggle("err",!t),n.textContent=e)};function v(){if(!s||!o)return;s.value.length>l&&(s.value=s.value.slice(0,l));const e=s.value.length;o.textContent=`${e}/500`,o.classList.toggle("warn",e>=450&&e<l),o.classList.toggle("limit",e>=l)}v();const h="contactFormMessage";if(s){const e=(()=>{try{return localStorage.getItem(h)}catch{return null}})();e&&(s.value=e,v()),s.addEventListener("input",()=>{try{localStorage.setItem(h,s.value)}catch{}})}e.addEventListener("input",t=>{const n=t.target;var r;n.matches("#name, #email, #subject, #service, #message, #phone, #consent")&&((r=n)&&(r.classList.remove("is-invalid"),r.removeAttribute("aria-invalid"))),n===s&&v(),[...e.querySelectorAll(".is-invalid")].length||(c&&c.classList.add("visually-hidden"),d&&d.classList.add("visually-hidden"))}),e.addEventListener("submit",async o=>{if(o.preventDefault(),"true"===e.getAttribute("aria-busy"))return;m("",!1);let g=!0;a.forEach(t=>{const n=e.querySelector("#"+t);n&&n.value&&n.value.trim()||(u(n),g=!1)});const f=e.querySelector("#email"),b=f?f.value.trim():"";f&&b&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(b)&&(u(f),g=!1,m("Wpisz poprawny adres e-mail.",!1));const y=e.querySelector("#phone");if(y){const e=y.value.trim();e&&!/^[0-9 +()-]{7,20}$/.test(e)&&(u(y),g=!1,m("Wpisz poprawny numer telefonu (np. +48 600 000 000).",!1))}const p=e.querySelector("#consent");p&&!p.checked&&(u(p),g=!1,m("Zaznacz zgodę na przetwarzanie danych.",!1));if(e.querySelector("[data-recaptcha]")&&!t){const t=e.querySelector('[name="g-recaptcha-response"]');t&&t.value||(g=!1,m("Potwierdź, że nie jesteś robotem (reCAPTCHA).",!1))}if(s&&s.value.length>l&&(u(s),g=!1,m("Wiadomość może mieć maks. 500 znaków.",!1)),!g){const t=[...e.querySelectorAll(".is-invalid")];if(c){const n=t.map(t=>{const n=t.id?e.querySelector(`label[for="${t.id}"]`):null;return n?n.textContent.trim():t.name||t.id||"Pole"}),r=t.length,i=1===r?"błąd":r>=2&&r<=4?"błędy":"błędów";c.textContent=`Formularz zawiera ${r} ${i}: ${n.join(", ")}.`,c.classList.remove("visually-hidden")}d&&d.classList.remove("visually-hidden");const r=t[0];return r&&r.focus(),void(n&&!n.textContent&&m("Uzupełnij wymagane pola.",!1))}e.setAttribute("aria-busy","true"),r&&(r.disabled=!0,r.classList.add("sending"),r.textContent="Wysyłanie…"),m("Wysyłanie…",!0);const w=new FormData(e),L=new URLSearchParams(w).toString();try{if(t)await new Promise(e=>setTimeout(e,500));else{if(!(await fetch("/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:L})).ok)throw new Error("Netlify response not OK")}e.setAttribute("aria-busy","false"),e.reset();try{localStorage.removeItem(h)}catch{}v(),m("Dziękujemy! Wiadomość została wysłana.",!0),r&&(r.classList.remove("sending"),r.classList.add("sent"),r.textContent="Wysłano ✓",setTimeout(()=>{r.disabled=!1},1200),setTimeout(()=>{m("",!0),r.classList.remove("sent"),r.textContent=i},6e3)),c&&c.classList.add("visually-hidden"),d&&d.classList.add("visually-hidden"),t||("function"==typeof gtag&&gtag("event","generate_lead",{event_category:"Formularz",event_label:"Kontakt — Budownictwo"}),"function"==typeof fbq&&fbq("track","Lead"))}catch(t){e.setAttribute("aria-busy","false"),r&&(r.disabled=!1,r.classList.remove("sending"),r.textContent=i),m("Ups! Nie udało się wysłać. Spróbuj ponownie za chwilę.",!1),console.error(t)}})})(),(()=>{const e=document.getElementById("lightbox");if(!e)return;const t=e.querySelector(".lb__img"),n=e.querySelector(".lb__caption"),r=e.querySelector(".lb__close"),i=e.querySelector(".lb__backdrop"),a=e.querySelector(".lb__figure");let s=[],o=0,l=null,c=null,d=null,u=null,m=null,v=null,h=[],g=null,f=null;const b=window.matchMedia?window.matchMedia("(hover: none) and (pointer: coarse)").matches:"ontouchstart"in window,y=(i,o)=>{v=document.activeElement,s.length||(t.src=i,t.alt=o||"",o&&o.trim()?(n.textContent=o,n.hidden=!1):(n.textContent="",n.hidden=!0)),e.removeAttribute("hidden"),e.setAttribute("aria-hidden","false"),document.body.classList.add("lb-open"),h=Array.from(e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(e=>!e.hasAttribute("disabled")&&null!==e.offsetParent),g=h[0],f=h[h.length-1],r&&r.focus(),function(){if(!a)return;c||(c=document.createElement("button"),c.type="button",c.className="lb__prev",c.setAttribute("aria-label","Poprzednie zdjęcie"),c.innerHTML="&#8249;",c.addEventListener("click",()=>{z()}),a.appendChild(c));d||(d=document.createElement("button"),d.type="button",d.className="lb__next",d.setAttribute("aria-label","Następne zdjęcie"),d.innerHTML="&#8250;",d.addEventListener("click",()=>{q()}),a.appendChild(d));u||(u=document.createElement("div"),u.className="sr-only",u.setAttribute("aria-live","polite"),e.appendChild(u));m||(m=document.createElement("button"),m.type="button",m.className="lb__fs",m.setAttribute("aria-pressed","false"),m.setAttribute("aria-label","Włącz pełny ekran"),m.textContent="⛶",m.addEventListener("click",()=>{A(),S()}),a.appendChild(m));S()}(),k()},p=()=>{e.setAttribute("aria-hidden","true"),document.body.classList.remove("lb-open"),t.removeAttribute("src"),n.textContent="",n.hidden=!0,h=[],g=f=null,e.classList.remove("is-immersive"),e.setAttribute("hidden",""),v&&"function"==typeof v.focus&&v.focus(),s=[],o=0,l=null,m&&(m.setAttribute("aria-pressed","false"),m.setAttribute("aria-label","Włącz pełny ekran"))},w=()=>!!document.fullscreenElement,L=()=>document.exitFullscreen?document.exitFullscreen():Promise.resolve(),E=()=>e.classList.contains("is-immersive"),A=()=>{return a&&a.requestFullscreen&&document.exitFullscreen?w()?L():(t=a)&&t.requestFullscreen?t.requestFullscreen():Promise.resolve():(e.classList.toggle("is-immersive"),S(),Promise.resolve());var t};function k(){if(!u||!s.length)return;const e=s.length;u.textContent=`Zdjęcie ${o+1} z ${e}`}function S(){if(!m)return;const e=w()||E();m.setAttribute("aria-pressed",String(e)),m.setAttribute("aria-label",e?"Wyłącz pełny ekran":"Włącz pełny ekran")}function x(e){if(!s.length)return;const r=s[e];if(!r)return;t.classList.add("is-fading");const i=()=>{t.classList.remove("is-fading"),t.removeEventListener("load",i)};t.addEventListener("load",i),t.src=r.href,t.alt=r.alt||"",r.alt&&r.alt.trim()?(n.textContent=r.alt,n.hidden=!1):(n.textContent="",n.hidden=!0),k(),function(e){if(!s.length)return;const t=s.length;[s[(e-1+t)%t],s[(e+1)%t]].forEach(e=>{if(e&&e.href){const t=new Image;t.decoding="async",t.src=e.href}})}(e)}function q(){s.length&&(o=(o+1)%s.length,x(o))}function z(){s.length&&(o=(o-1+s.length)%s.length,x(o))}document.addEventListener("click",e=>{const t=e.target.closest(".gallery-link");if(!t||!t.closest(".gallery-container"))return;e.preventDefault();const n=t.getAttribute("href"),r=t.querySelector("img"),i=r?r.alt:"";l=t.closest(".gallery-container");const a=l?Array.from(l.querySelectorAll(".gallery-link")):[t];s=a.map(e=>{const t=e.querySelector("img");return{href:e.getAttribute("href"),alt:t?t.alt:""}}).filter(e=>!!e.href),o=Math.max(0,s.findIndex(e=>e.href===n)),y(n,i),x(o)}),i&&i.addEventListener("click",()=>{w()?L().finally(()=>p()):(E()&&e.classList.remove("is-immersive"),p())}),t&&(t.addEventListener("click",()=>{A()}),t.addEventListener("dblclick",e=>{e.preventDefault(),A()})),function(){if(!a)return;let e=0,t=0,n=!1,r=0,i=0,s=!1;const o=()=>{n&&Math.abs(r)>48&&(r<0?q():z()),n=!1,s=!1,r=i=0};a.addEventListener("pointerdown",a=>{var o,l;o=a.clientX,l=a.clientY,e=o,t=l,n=!1,r=0,i=0,s=!0}),a.addEventListener("pointermove",a=>{var o,l,c;o=a.clientX,l=a.clientY,c=a,s&&(r=o-e,i=l-t,n||Math.abs(r)>12&&Math.abs(r)>1.5*Math.abs(i)&&(n=!0),n&&c&&c.cancelable&&c.preventDefault())},{passive:!0}),a.addEventListener("pointerup",o),a.addEventListener("pointercancel",o),a.addEventListener("pointerleave",()=>{s&&o()})}(),r&&r.addEventListener("click",p),document.addEventListener("keydown",t=>{if("false"===e.getAttribute("aria-hidden"))if("Escape"===t.key){if(t.preventDefault(),w())return void L();if(E())return void e.classList.remove("is-immersive");p()}else"ArrowRight"===t.key?(t.preventDefault(),q()):"ArrowLeft"===t.key?(t.preventDefault(),z()):"Tab"===t.key&&(e=>{h.length&&(e.shiftKey&&document.activeElement===g?(e.preventDefault(),f.focus()):e.shiftKey||document.activeElement!==f||(e.preventDefault(),g.focus()))})(t)}),document.addEventListener("fullscreenchange",()=>{w()||e.classList.remove("is-immersive"),S()}),b||document.addEventListener("mouseenter",e=>{const t=e.target;if(!t||1!==t.nodeType||"function"!=typeof t.closest)return;const n=t.closest(".gallery-link");if(!n||!n.closest(".gallery-container"))return;const r=n.getAttribute("href");if(!r)return;const i=new Image;i.decoding="async",i.src=r},!0)})(),(()=>{let e=!1,t=!1;const n=()=>{var t;(t=(window.scrollY||window.pageYOffset||0)>20)!==e&&(e=t,document.body.classList.toggle("header-compact",e))},r=()=>{t||(t=!0,requestAnimationFrame(()=>{n(),t=!1}))};n(),window.addEventListener("scroll",r,{passive:!0}),window.addEventListener("resize",r),window.addEventListener("pageshow",n,{once:!0});const i=document.getElementById("hamburger");i&&i.addEventListener("click",()=>{setTimeout(n,0)});new MutationObserver(n).observe(document.body,{attributes:!0,attributeFilter:["class"]})})(),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").catch(()=>{})});